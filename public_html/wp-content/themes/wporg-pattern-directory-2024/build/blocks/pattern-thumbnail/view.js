import*as e from"@wordpress/interactivity";var t={d:(e,r)=>{for(var s in r)t.o(r,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const r=(o={getContext:()=>e.getContext,store:()=>e.store},d={},t.d(d,o),d),{actions:s,state:a}=(0,r.store)("wporg/patterns/thumbnail",{state:{attempts:0,shouldRetry:!0,hasError:!1,get base64Image(){return(0,r.getContext)().base64Image},get hasLoaded(){return a.base64Image||a.hasError}},actions:{setShouldRetry(e){a.shouldRetry=e},setHasError(e){a.hasError=e},setBase64Image(e){(0,r.getContext)().base64Image=e},*fetchImage(e){try{const t=yield fetch(e);if(a.attempts++,t.redirected)s.setShouldRetry(!0);else if(200===t.status&&!t.redirected){const e=yield t.blob(),r=yield new Promise((t=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.readAsDataURL(e)}));s.setBase64Image(r),s.setShouldRetry(!1)}}catch(e){s.setHasError(!0),s.setShouldRetry(!1)}}},callbacks:{*init(){const{src:e}=(0,r.getContext)();if(!a.base64Image)for(yield s.fetchImage(e);a.shouldRetry;)yield new Promise((e=>{setTimeout((()=>e()),2e3)})),yield s.fetchImage(e),a.attempts>=10&&(s.setHasError(!0),s.setShouldRetry(!1))}}});var o,d;